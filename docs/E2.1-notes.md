# E2.1 Notes â€” Roles, Capabilities, and Guest Gating

## What Changed
- Added WordPress roles for marketplace actors:
  - `olive_supplier_enterprise` (Supplier Enterprise)
  - `olive_supplier_private` (Supplier Private)
  - `olive_professional` (Professional)
  - `olive_buyer` (Buyer)
- Added CPT-specific capabilities for `olive_offer` and `olive_rfq`.
- Enforced business rules:
  - Buyers can create RFQs (`create_olive_rfqs`)
  - Suppliers/Professionals can create Offers (`create_olive_offers`)
- Added automatic role/cap sync on plugin init + activation.
- Added guest gating for single Supplier/Offer/RFQ pages:
  - Guest sees summary only and login CTA.
  - Supplier identity/title is masked for guests on single supplier pages.

## How To Test
1. Ensure plugin is active: `oliveb2b-core`
2. Verify roles:
   - `docker compose run --rm --user 0:0 --entrypoint wp wpcli role list --fields=role,name --format=table --allow-root --path=/var/www/html`
3. Verify caps:
   - Buyer has `create_olive_rfqs` and no `create_olive_offers`
   - Supplier Enterprise has `create_olive_offers`
4. As guest, open a single Supplier/Offer/RFQ URL and confirm:
   - Summary-only content
   - Login prompt
   - Supplier title masked on supplier single
